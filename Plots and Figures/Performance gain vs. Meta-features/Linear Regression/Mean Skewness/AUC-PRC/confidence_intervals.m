clear all
x = [13.400763460651607,
 12.46694081190181,
 0.1772091728597697,
 0.8666598092191451,
 13.430891536012652,
 -0.11929141888260075,
 -0.10256429558365629,
 -0.1299873514815711,
 -0.14495273267628106,
 -0.1368173350876412,
 2.2631111929251575,
 2.1472779623396088,
 2.145131713893545,
 2.4557289152173274,
 2.3877222780259224,
 0.9371070959185053,
 1.227003395360341,
 0.9246086644812401,
 0.904734234417667,
 0.9653685299391247,
 1.8111231532597587,
 1.4254419512795051,
 1.6131053146661185,
 1.8928643818284892,
 1.8099531753391231,
 2.2860211034694427,
 1.5097837506182756,
 1.4583407664182633,
 1.8958471681780102,
 2.2782336391359883,
 0.20017257538563762,
 0.19397881068931727,
 0.19577205663343805,
 0.19960722708188985,
 0.20105669932872164,
 0.47294971900414867,
 0.4857962497567794,
 0.24055952938920316,
 0.5581090696970488,
 0.516037020170087,
 1.7589374649444551,
 -0.9416135631548969,
 0.24288164498245088,
 1.4368402161353453,
 2.119259645018911,
 0.07888739587449026,
 0.0831925163262669,
 -0.047892873581685896,
 0.07663136714604366,
 0.03601224181754609,
 0.7212364653646569,
 0.7689367807802338,
 0.568973067820088,
 0.5550073853502807,
 0.5167914953890398,
 -0.38250248231941947,
 -0.3818247761933579,
 -0.3611228856169687,
 -0.383884001363244,
 -0.3764312330941424,
 1.1167062432952228,
 0.48515779551295063,
 0.9576260211433139,
 0.9652286208185307,
 1.0918626912446467,
 0.5292461289375205,
 0.5556956294148352,
 0.6057315553243587,
 0.6148663871502589,
 0.5552670207732879,
 3.307284890057735,
 0.7526598487398686,
 1.0466205599953184,
 3.437591522221576,
 3.027438927910237,
 -0.3340250545763989,
 -0.34064232721602056,
 -0.3281700411306505,
 -0.3359153118656175,
 -0.33321708772379954,
 0.9672196487827536,
 0.9195342537429473,
 0.9123558459464718,
 0.9294931911674639,
 0.954226607429055,
 11.18663909602842,
 9.066742343340911,
 9.919163273528625,
 10.873158083711717,
 10.674410374766257,
 1.9958398518231488,
 3.200408163797187,
 1.6544601349650827,
 2.2473192466426477,
 1.9146936686739984,
 1.1216900336034705,
 1.9181449073840533,
 0.4809684207455047,
 1.2979445171501192,
 1.191233055923061];

y = [0.2902708259641896,
 0.1747134930181895,
 0.25696983245286087,
 0.2987530563814511,
 0.29130292699354865,
 0.04371203675551494,
 0.008926218708827482,
 0.019554030874785577,
 0.04223905723905719,
 0.013381001021450456,
 0.13127801120448176,
 0.2797619047619048,
 0.07083333333333336,
 0.05694444444444441,
 0.03662464985994407,
 0.025308947108255153,
 0.0,
 0.056321839080459846,
 0.0,
 0.022410459910459868,
 0.051141166525781934,
 0.25,
 0.0,
 0.1339285714285714,
 0.21796916533758637,
 0.00454545454545463,
 0.18095238095238098,
 0.6666666666666667,
 0.33333333333333337,
 0.19117647058823528,
 0.06662664879296315,
 0.058918801563178524,
 0.056515960602824156,
 0.06354715572407327,
 0.09204107664406402,
 0.02894019560686223,
 0.0,
 0.10197802197802197,
 0.040125840125840195,
 -0.036106750392464804,
 0.0,
 0.25,
 0.1875,
 0.17439703153988872,
 0.20952380952380956,
 0.0,
 0.0,
 0.0,
 0.125,
 0.0,
 0.45000000000000007,
 0.38888888888888895,
 0.14999999999999997,
 0.08333333333333333,
 0.0,
 0.05719119958518171,
 0.051613337642749446,
 0.06819983199863766,
 0.04439159465061937,
 0.055677745173246196,
 0.06076388888888884,
 0.33333333333333337,
 0.0535714285714286,
 0.06285072951739612,
 0.016132478632478797,
 0.04070803797205991,
 0.06576024171332084,
 -0.03235581622678396,
 0.03779732811990888,
 0.05603512782728037,
 -0.011938094394234766,
 0.10119047619047616,
 0.07365967365967363,
 0.06015037593984962,
 0.06403162055335965,
 0.05563952445732756,
 0.057515703857212275,
 0.057419011688900845,
 0.056778325022668,
 0.0544967223676307,
 0.12885154061624648,
 0.15555555555555556,
 0.14141414141414144,
 0.19000000000000006,
 0.0,
 0.04884249428406118,
 0.029534067449178858,
 0.04464502888415933,
 0.047956557110041986,
 0.06813557153845162,
 0.015403368794326217,
 0.08038277511961728,
 0.007017543859649124,
 0.01855600539811067,
 0.020175438596491235,
 0.10467297275446685,
 0.13888888888888884,
 0.36476190476190473,
 0.1611842105263157,
 0.0];

xs = linspace(-1, 13.5)';

meanfunc = [];                    % empty: don't use a mean function
covfunc = @covSEiso;              % Squared Exponental covariance function
likfunc = @likGauss;              % Gaussian likelihood

%Initialise hyperparameters structure
hyp = struct('mean', [], 'cov', [-1 0], 'lik',0);
hyp2 = minimize(hyp, @gp, -100, @infGaussLik, meanfunc, covfunc, likfunc, x,y);
K = feval(covfunc, hyp2.cov, x);
%Obtain the predictive mean and variance of test points
[mu,s2] = gp(hyp2, @infGaussLik, meanfunc, covfunc, likfunc,x,y,xs);

%Compute the (joint) negative log probability (density): nlml
nlml = gp(hyp2, @infGaussLik, meanfunc, covfunc, likfunc, x, y);
%Plot the predictive mean with predictive 95% confidence bounds and training data
f = [mu+2*sqrt(s2); flip(mu-2*sqrt(s2),1)];
fill([xs; flip(xs,1)], f, [7 7 7]/8)
hold on; plot(xs, mu, 'b'); plot(x,y,'r.','LineWidth',1)
xlabel('Mean skewness','FontSize',14)
ylabel('﻿Performance gain of ML vs. Statistics','FontSize',14)
a = get(gca,'XTickLabel');
b = get(gca,'YTickLabel');
set(gca,'XTickLabel',a,'fontsize',14)
set(gca,'XTickLabel',b,'fontsize',14)
title('﻿Performance gain (AUC-PRC) vs. Mean skewness','FontSize',14)
legend('95% predictive error bars', 'Predictive mean', 'Data', 'FontSize',12)
xlim([-1 13.5]);
xticks(linspace(-1,14, 15));


